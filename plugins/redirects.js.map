{"version":3,"sources":["../lib/plugins/redirects.js"],"names":["options","files","metalsmith","done","redirects","createInterface","input","on","line","split","push","src","dest","metadata","r","dbg"],"mappings":";;;;;;kBAYe,UAAUA,OAAV,EAAmB;AAChC,SAAO,CAACC,KAAD,EAAQC,UAAR,EAAoBC,IAApB,KAA6B;AAClC,QAAIC,YAAY,EAAhB;AACA,uBAASC,eAAT,CAAyB;AACvBC,aAAO,0BAAiB,eAAjB;AADgB,KAAzB,EAGCC,EAHD,CAGI,MAHJ,EAGaC,IAAD,IAAU;AACpBA,aAAOA,KAAKC,KAAL,CAAW,GAAX,CAAP;AACAL,gBAAUM,IAAV,CAAe,EAAEC,KAAKH,KAAK,CAAL,CAAP,EAAgBI,MAAMJ,KAAK,CAAL,CAAtB,EAAf;AACD,KAND,EAOCD,EAPD,CAOI,OAPJ,EAOa,MAAM;AACjBL,iBAAWW,QAAX,CAAoB,oBAAOX,WAAWW,QAAX,EAAP,EAA8B,EAAET,SAAF,EAA9B,CAApB;AACA,wBAAKA,SAAL,EAAiBU,CAAD,IAAOC,IAAK,GAAED,EAAEH,GAAI,MAAKG,EAAEF,IAAK,EAAzB,CAAvB;AACAT;AACD,KAXD;AAYD,GAdD;AAeD,C;;AA5BD;;AAIA;;;;AACA;;;;AACA;;;;AAIA,IAAIY,MAAM,qBAAM,WAAN,CAAV","file":"redirects.js","sourcesContent":["import {\n  extend,\n  each\n} from 'lodash'\nimport debug from 'debug'\nimport readline from 'readline'\nimport {\n  createReadStream\n} from 'fs'\n\nlet dbg = debug('redirects')\n\nexport default function (options) {\n  return (files, metalsmith, done) => {\n    let redirects = []\n    readline.createInterface({\n      input: createReadStream('redirects.csv')\n    })\n    .on('line', (line) => {\n      line = line.split(',')\n      redirects.push({ src: line[0], dest: line[1] })\n    })\n    .on('close', () => {\n      metalsmith.metadata(extend(metalsmith.metadata(), { redirects }))\n      each(redirects, (r) => dbg(`${r.src} > ${r.dest}`))\n      done()\n    })\n  }\n}\n"]}