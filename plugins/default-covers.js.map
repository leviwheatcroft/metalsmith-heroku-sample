{"version":3,"sources":["../lib/plugins/default-covers.js"],"names":["options","files","metalsmith","done","cloudinary","metadata","images","Object","keys","imageMask","articles","articleMask","forEach","file","cover","key","Math","floor","length","charCodeAt","dbg","get"],"mappings":";;;;;;kBAMe,UAAUA,OAAV,EAAmB;AAChC,SAAO,CAACC,KAAD,EAAQC,UAAR,EAAoBC,IAApB,KAA6B;AAClC,QAAIC,aAAaF,WAAWG,QAAX,GAAsBD,UAAvC;AACA,QAAIE,SAAS,0BAAWC,OAAOC,IAAP,CAAYJ,UAAZ,CAAX,EAAoCJ,QAAQS,SAA5C,CAAb;AACA,QAAIC,WAAW,0BAAWH,OAAOC,IAAP,CAAYP,KAAZ,CAAX,EAA+BD,QAAQW,WAAvC,CAAf;AACAD,aAASE,OAAT,CAAkBC,IAAD,IAAU;AACzB,UAAIZ,MAAMY,IAAN,EAAYC,KAAhB,EAAuB;AACrBb,cAAMY,IAAN,EAAYC,KAAZ,GAAoBV,WAAWH,MAAMY,IAAN,EAAYC,KAAvB,CAApB;AACA;AACD;AACD,UAAIC,GAAJ;AACAA,YAAMC,KAAKC,KAAL,CAAWJ,KAAKK,MAAL,GAAc,CAAzB,CAAN;AACAH,YAAMF,KAAKM,UAAL,CAAgBJ,GAAhB,CAAN;AACAA,YAAMA,MAAMT,OAAOY,MAAnB;AACAH,YAAMT,OAAOS,GAAP,CAAN;AACAd,YAAMY,IAAN,EAAYC,KAAZ,GAAoBV,WAAWW,GAAX,CAApB;AACD,KAXD;AAYAZ;AACD,GAjBD;AAkBD,C;;AAzBD;;;;AACA;;;;AACA;;;;;;AAEA,MAAMiB,MAAM,qBAAM,iBAAOC,GAAP,CAAW,cAAX,CAAN,CAAZ","file":"default-covers.js","sourcesContent":["import debug from 'debug'\nimport multimatch from 'multimatch'\nimport config from 'config'\n\nconst dbg = debug(config.get('project-name'))\n\nexport default function (options) {\n  return (files, metalsmith, done) => {\n    let cloudinary = metalsmith.metadata().cloudinary\n    let images = multimatch(Object.keys(cloudinary), options.imageMask)\n    let articles = multimatch(Object.keys(files), options.articleMask)\n    articles.forEach((file) => {\n      if (files[file].cover) {\n        files[file].cover = cloudinary[files[file].cover]\n        return\n      }\n      let key\n      key = Math.floor(file.length / 2)\n      key = file.charCodeAt(key)\n      key = key % images.length\n      key = images[key]\n      files[file].cover = cloudinary[key]\n    })\n    done()\n  }\n}\n"]}